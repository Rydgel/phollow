---
date: '2010-09-15 20:48:06'
layout: post
slug: optimisation-wordpress-vitesse-performances
status: publish
title: Optimisation Wordpress, vitesse & performances
wordpress_id: '2693'
categories:
- logiciel libre
- tutoriel
- web
tags:
- css
- js
- optimisation
- wordpress
---

<a href="http://static.phollow.fr/2010/09/wp.jpg"><img class="mainimage alignnone size-full wp-image-2696" title="wp" src="http://static.phollow.fr/2010/09/wp.jpg" alt="" width="804" height="300" /></a>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>La vitesse de chargement d'une page web est critique en terme d'expérience utilisateur.</em></p>
<p style="text-align: justify;">Regardons les choses en face : si une page met trop de temps à s'ouvrir, je ne vais pas rester. Le contenu, aussi intéressant soit-il, ne sera pas lu. Sous prétexte que le haut débit est maintenant répandu, les gens oublient de faire au plus léger.<strong> </strong>Les images non-spritées, le CSS redondant et les vingtaines de requêtes http par pages sont devenus légion. Et on semble se satisfaire de quelques secondes pour ouvrir une page.</p>
<p style="text-align: justify;"><!--more--></p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Une seconde c'est déjà trop !</em></p>
<p style="text-align: justify;"><a href="http://radar.oreilly.com/2009/06/bing-and-google-agree-slow-pag.html">Bing et Google</a> sont d'accord pour dire que les pages <em>lentes</em> perdent des utilisateurs. Personnellement je n'attends pas plus de 3 secondes à l'ouverture d'un site web. Je ferme l'onglet. C'est dans cette optique que je me suis mis en tête d'optimiser mon installation Wordpress et gagner de précieuses secondes.</p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Les outils nécessaires pour benchmarker son blog.</em></p>

</div>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">Firefox</p>
<p style="text-align: justify;">Je me fais pas de soucis pour vous. Vous devez tous l'avoir. J'espère.. On en a besoin pour Firebug. Au pire on le trouve sur <a href="http://www.mozilla-europe.org/fr/firefox/">cette page</a>.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">Firebug</p>
<p style="text-align: justify;">L'extension reine pour les développeurs web. Vous devriez déjà l'avoir, sinon vous pouvez la récupérer sur <a href="http://getfirebug.com/">cette page</a>. On en a besoin pour YSlow.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">YSlow</p>
<p style="text-align: justify;">Un plugin Firebug fait par Yahoo. Il analyse la page web et donne une note suivant plusieurs critères. Dans le but d'avoir une page web rapide. <a href="http://developer.yahoo.com/yslow/">Lien</a>.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">Webkit Web Inspector</p>
<p style="text-align: justify;">Disponible à l'intérieur de <a href="http://google.com/chrome">Chrome</a>, <a href="http://apple.com/safari">Safari</a> &amp; d'autres navigateurs webkit. Il donne des infos intéressantes, notamment avec son onglet des ressources. Pratique pour voir la taille des différents fichiers, et le temps mis pour les télécharger.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">Page Speed</p>
<p style="text-align: justify;">Encore un plugin pour Firebug. Il propose à peu près la même chose que YSlow. <a href="http://code.google.com/speed/page-speed/">Lien</a>.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px; font-style: italic;">Webmaster Tools</p>
<p style="text-align: justify;">Un must-have. Google enregistre aussi la vitesse d'ouverture de notre site au cours du temps. Pratique. <a href="http://google.com/webmasters/tools">Lien</a>.</p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Optimisation de la taille des fichiers CSS.</em></p>

</div>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Le code !</em></p>
<p style="text-align: justify;">La première étape est d'avoir un CSS optimisé au niveau du code. Je vois parfois des devs qui mettent <em>tout</em> le chemin du DOM dans leurs règles CSS. Il faut aller au plus simple :</p>

<pre lang="css">#footer nav ul li a  /*pas bien */
#footer a { ... } /* bieeeen */</pre>
<p style="text-align: justify;">Autrement dit, essayez de voir si vous ne pouvez pas réduire la taille du fichier simplement en écrivant moins de code.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Compression</em></p>
<p style="text-align: justify;">On peut réduire énormément la taille des fichiers CSS en les <em>minifiant</em>. Les retours à la ligne inutiles, les commentaires et les espaces en trop seront supprimés. À faire uniquement quand on ne touche plus au fichier, car ça devient complètement illisible. Le problème c'est que pas mal de plugins Wordpress viennent avec leurs propres CSS pas forcément compressés. Vous pouvez le faire vous même en les remplaçant. Mais à chaque mise à jour du plugin.. on recommence. À vous de voir !</p>
<p style="text-align: justify;"><a href="http://www.minifycss.com/">Minify CSS</a></p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Et à propos des fichiers Javascripts ?</em></p>

</div>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Placement</em></p>
<p style="text-align: justify;">Souvent les appels aux fichiers .js se trouvent dans la balise &lt;head&gt; de la page. Le problème avec ça, c'est que pour voir le contenu de la page, ces fichiers doivent d'abord être chargés. Autant que possible je place mes fichiers javascript juste avant la fin de la balise &lt;body&gt;. De cette manière le contenu de la page peut déjà s'afficher et les fichiers javascripts se charger en arrière-plan. J'essaye aussi de charger tout mes scripts de manière asynchrone.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Compression</em></p>
<p style="text-align: justify;">Sur le même principe que les fichiers css, la compression marche aussi pour le javascript.</p>
<p style="text-align: justify;"><a href="http://www.minifycss.com/">Minify CSS</a></p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Faire attention aux images aussi.</em></p>

</div>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Sprites</em></p>
<p style="text-align: justify;">15 images = 15 requêtes http. 1 sprite = 1 requête http. Faire un sprite c'est juste mettre toutes vos images dans une seule. Pratique volée aux créateurs de jeux-vidéo ;)</p>
<p style="text-align: justify;"><a href="http://spriteme.org/">SpriteMe</a></p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>La taille des images</em></p>
<p style="text-align: justify;">Vous voulez afficher une image en 150x150, et bien enregistrez la en tant que telle. Google <a href="http://code.google.com/speed/page-speed/docs/rendering.html#SpecifyImageDimensions">conseille</a> aussi de rajouter dans la balise &lt;img&gt; la taille de l'image en dur, pour accélérer le rendu. Enfin jouez sur la compression de l'image pour gagner de précieux ko.</p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Et mon serveur alors ?</em></p>

</div>
<p style="text-align: justify;">Il peut aussi nous aider dans notre tâche.</p>

<ul>
	<li>En compressant en Gzip les données envoyées.</li>
	<li style="text-align: justify;">En mettant des headers spéciaux aux fichiers, pour que les utilisateurs les gardent en cache.</li>
</ul>
<p style="text-align: justify;">Si vous êtes sous Apache il suffit de rajouter les lignes suivantes dans votre .htaccess (après les règles Wordpress). Vous devez avoir certains modules activés (mod_expires, mod_headers, mod_gzip).</p>
<script src="http://gist.github.com/427761.js?file=webperformant.htaccess"></script>
<p style="text-align: justify;">La même chose est possible sous Nginx &amp; Lighttpd. Si ça vous interesse je peux en parler dans un autre article.</p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Et maintenant le coeur de Wordpress.</em></p>

</div>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Plugins à désactiver</em></p>
<p style="text-align: justify;">Désactivez ce que vous n'utilisez pas. Ça doit être un réflexe. Car chaque plugin vient avec son lot de js/css/php qui se charge à chaque page ou presque.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>Système de cache</em></p>
<p style="text-align: justify;">C'est l'élément le plus important de notre installation. Celui qui va nous faire gagner pas mal de temps et pas mal de ressources serveur. Par défaut, pour chaque page, le blog fait des requêtes SQL pour chercher les infos à afficher. Le truc c'est que le contenu d'un billet change rarement après la soumission. Mettre ces infos en cache permet de sauter l'étape BDD et d'afficher la page comme si c'était une page web html.</p>
<p style="text-align: justify;">J'utilise personnellement <a href="http://wordpress.org/extend/plugins/w3-total-cache/">W3 Total Cache</a>. Il propose plein de trucs sympathiques : il peut par exemple prendre en compte l'envoi des données en Gzip si vous avez la flemme de le faire à la main dans le .htaccess.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;"><em>WP Minify</em></p>
<p style="text-align: justify;">Je vous ai raconté dans la première partie comment réduire la taille des fichiers js et css. Et bien ce plugin le fait pour vous en fait. Et le truc génial c'est qu'il les combine en un seul fichier pour réduire le nombre de requêtes http. Il se trouve <a href="http://omninoggin.com/wordpress-plugins/wp-minify-wordpress-plugin/">ici</a>.</p>

<div class="mainimage" style="padding: 5px; background-color: #dce8f4; width: 799px; height: 35px;">
<p style="font-size: 24px; font-weight: 100; text-align: justify; line-height: 32px;"><em>Pour finir...</em></p>

</div>
<p style="text-align: justify;">On va dire que tout ça ce sont les grandes lignes. Il y a toujours moyen de faire mieux. Mais disons que c'est la petite <em>todo-list</em> que je vais essayer de mettre en place (j'ai déjà commencé). Il est possible que techniquement vous ne puissiez pas tout faire.. l'important est d'essayer de faire au mieux. Même si vous n'avez pas l'impression de gagner énormément à chaque étape.. le tout cumulé lui sera visible.</p>
<p style="text-align: justify;">En lançant YSlow entre chaque optimisation, on peut vite se rendre compte de ce qu'il reste à faire.</p>
<p style="font-size: 18px; font-weight: 300; text-align: justify; line-height: 26px;">Pour un meilleur web ;)</p>