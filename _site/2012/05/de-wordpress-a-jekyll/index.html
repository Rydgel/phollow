<!doctype html>
<html class="no-js" lang="fr" dir="ltr" itemscope itemtype="http://schema.org/Article" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml">
<head id="phollow-fr" data-template-set="html5-phollow-wordpress-theme" profile="http://purl.org/uF/hAtom/0.1/ http://purl.org/uF/2008/03/" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# phollow: http://ogp.me/ns/fb/phollow#">
  <meta charset="UTF-8">
  <title>De Wordpress à Jekyll</title>
  <link href="https://plus.google.com/116513653525162928064" rel="publisher">
  <meta name="title" content="De Wordpress à Jekyll">
  <meta name="author" content="Jérôme Mahuet">
  <meta name="Copyright" content="Copyright Jérôme Mahuet 2012. All Rights Reserved.">
  <meta name="google-site-verification" content="b3k5NRe5t9U-Pk1_CK_g5oN0U12YXuc55rUQWCHgbZY">
  <meta property="og:title" content="De Wordpress à Jekyll">
  <meta property="og:type" content="phollow:post">
  <meta property="og:site_name" content="Phollow.me">
  <meta property="fb:admins" content="rydgel">
  <meta property="fb:app_id" content="101739241646">
  <meta itemprop="name" content="De Wordpress à Jekyll">
  <meta http-equiv="cleartype" content="on">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="/css/compiled/global.css?v=10">
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="/atom.xml">
  <script src="/js/compiled/modernizr.min.js"></script>
  <script>
  WebFontConfig = {
    fontdeck: {
      id: '19429'
    }
  };

  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
    '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
  </script>
</head>
<body>
  <div class="container" role="wrapper">
    <header role="banner" id="header-site" class="sixteen columns">
      <h1 id="logo" class="four columns alpha">
        <a href="/" title="Phollow.me">Phollow.me</a>
      </h1>
      <nav id="nav-header" class="twelve columns omega">
        <ul>
          <li><a title="Phollow Archives" href="/archives/">Archives</a></li>
          <li><a target="_blank" title="about" href="http://jrm.li">Myself</a></li>
          <li><a target="_blank" title="@phollow" href="http://twitter.com/@phollow">Twitter</a></li>
          <li><a target="_blank" title="Phollow.fr RSS Feed" href="http://feeds2.feedburner.com/phollow/iuEO" target="_blank">RSS feed</a></li>
        </ul>
      </nav>
      <hr style="border-bottom: 1px solid rgba(0, 0, 0, 0.02);">
    </header>

<div id="container" class="sixteen columns">
  <article class="post">
      <header>
    <h2 class="entry-title entry-single"><a href="/2012/05/de-wordpress-a-jekyll">De Wordpress à Jekyll</a></h2>
      </header>
      <div class="entry single-page ten columns offset-by-three alpha">
        <div>
<figure><figcaption><img style="margin-top: 0;" src="http://s3-eu-west-1.amazonaws.com/phollow/2012/05/dr_jekyll_mr_hyde_low.jpg" title="jekyll" class="alignnone size-full"></figcaption>
</figure>
</div>




<p class="lettrine">Cela fait plusieurs mois que j’en avait envie, je l’ai finalement fait ce week-end : une migration <em>complète</em> de mon blog Wordpress vers Jekyll. Vous ne devriez pas voir énormément de différences… Non, la différence est surtout pour moi, l’écriture et la gestion du site.</p>


<p>Je n’étais pas vraiment malheureux avec Wordpress, non. Seulement embêté par certaines <em>fonctionnalités</em>. Par exemple l’édition d’articles est juste infâme, je finissais souvent par utiliser l’éditeur HTML en fait. La performance de Wordpress est minable sans plugin externe (cache), car il fait les mêmes requêtes SQL à chaque pages vues. <em>On ne sait jamais, peut-être que l’article change toutes les 5 minutes ?</em></p>

<p>Bref, je m’égare en trollant, parlons un peu de cette migration.</p>

<h3>Jekyll</h3>

<p><a href="http://jekyllrb.com/">Jekyll</a> est un “générateur de sites statiques”, écrit en Ruby. Il y en a d’autres comme <a href="http://ringce.com/hyde">Hyde</a> ou Blatter en Python. J’ai essayé Jekyll et Hyde, j’ai trouvé le premier plus flexible, notamment au niveau de la gestion des filtres Liquid customisé et des permalinks.</p>

<h3>Pourquoi avoir migré sur un système statique ?</h3>

<p>Plusieurs raisons à cela mon bon monsieur.</p>

<h4>Gain de mémoire et performances</h4>

<p>Ce blog est hébergé sur un petit serveur virtuel. PHP et MySQL étant assez gourmand au niveau mémoire, me passer d’eux est non négligeable avec mes 512mb de RAM.</p>

<p>N’ayant pas énormément de visites, on ne peut pas dire que mes instances PHP travaillaient beaucoup. Mais on ne peut pas battre la performance de pages .html directement servies par Nginx.</p>

<h4>Plus simple pour écrire</h4>

<p>Sur Wordpress quand tu veux écrire un article, tu dois t’identifier dans l’interface d’administration, chercher le lien pour ajouter un article dans <strong>le bordel ambiant</strong>, cliquer dessus, et là tu peux commencer à t’amuser. Ah et tu dois être connecté aussi.</p>

<p>Avec Jekyll, mes articles sont de simples fichiers textes en Markdown ou HTML. Je peux écrire et tester le rendu de l’article localement sans avoir besoin d’être connecté aux internets.</p>

<h4>Backup</h4>

<p>Le site n’est qu’un ensemble de fichiers, donc <strong>Git</strong>.</p>

<h3>Utilisation</h3>

<p>Généralement un site basique sous Jekyll ressemble à ça :</p>

<div class="highlight"><pre><code class="sh">.
|-- _config.yml
|-- _includes
|-- _layouts
|   |-- default.html
|   <span class="sb">`</span>-- post.html
|-- _posts
|   |-- 2007-10-29-why-every-programmer-should-play-nethack.textile
|   <span class="sb">`</span>-- 2009-04-26-barcamp-boston-4-roundup.textile
|-- _site
<span class="sb">`</span>-- index.html
</code></pre>
</div>


<h4>_config.yml</h4>

<p>Diverses variables utilisées pour la configuration, comme les permalinks, le moteur de rendu Markdown et d’autres choses.</p>

<h4>_includes</h4>

<p>Généralement des <em>partials</em> que vous pouvez utiliser dans vos templates. Si vous avez plusieurs bouts de HTML qui se répète un peu partout dans vos pages, c’est bon de les factoriser ici.</p>

<h4>_layouts</h4>

<p>Les templates de vos pages web.</p>

<h4>_posts</h4>

<p>Vos articles écrits en .html, .markdown ou .textile. Jekyll se basera sur l’extension lors de la compilation.</p>

<h4>_site</h4>

<p>Après compilation, toutes les pages iront dans ce dossier. C’est sur ce dossier que vous devez faire pointer votre serveur web.</p>

<h4>Lancer Jekyll en local</h4>

<pre><code>jekyll --server</code></pre>


<h3>Migrations</h3>

<p>J’avais vraiment envie de garder l’existant, et donc il a fallut trouver des astuces pour la migration. Rentrons dans le vif du sujet.</p>

<h4>Bouger le contenu</h4>

<p>Pour rapatrier les articles, j’ai utilisé un utilitaire appelé <a href="https://github.com/thomasf/exitwp">exitwp</a>. Je n’ai pas converti les anciens articles en Markdown pour garder au maximum le rendu qu’avaient les anciens articles (oui parce que Wordpress te rajoute plein de merdes en HTML, qui aurait été viré avec la conversion). Heureusement rien ne m’empêche d’écrire les nouveaux billets autrement.</p>

<p>Wordpress met généralement tout ce que tu uploads dans un dossier. J’ai voulu les mettre sur Amazon pour gagner de l’espace disque. J’ai utilisé cette commande :</p>

<pre><code>s3cmd put --acl-public --recursive --guess-mime-type * s3://phollow</code></pre>


<h4>Note sur les commentaires</h4>

<p>Avec un site statique tu ne peux plus utiliser un système de commentaires <em>server-side</em>. Du coup on peut se rabattre sur un système comme Disqus ou Livefyre. <strong>Important</strong> : pour importer les anciens commentaires, il suffit d’installer un de ces systèmes sur Wordpress <strong>avant</strong> la migration.</p>

<h3>Code source</h3>

<p>Je mets à disposition le code source de la nouvelle version du site sur Github à cette <a href="https://github.com/Rydgel/phollow">adresse</a>. Il y a quelques trucs sympas, dont un Rakefile qui permet le déploiement des articles au travers de rsync.</p>

<pre><code>rake deploy</code></pre>


      </div>
      <cite class="omega three columns entry-meta">
        <p>
          <time datetime="2012-05-06 23:00:00 +0200" pubdate class="updated">
            May  6, 2012</time>
            <br>
          <a href="/category/web" rel="category tag">web</a>, <a href="/category/blog" rel="category tag">blog</a></p>
        </cite>
      <footer class="share">
      <a href="http://twitter.com/share" class="twitter-share-button" data-text="De Wordpress à Jekyll" data-count="horizontal" data-via="phollow" data-lang="fr">Tweet</a>
      </footer>
    </article>
      <hr>
      <div id="disqus_thread"></div>
      <script>
          var disqus_shortname = 'phollowfr';
          var disqus_identifier = 'http://phollow.fr/2012/05/de-wordpress-a-jekyll/';
          var disqus_url = 'http://phollow.fr/2012/05/de-wordpress-a-jekyll/';

          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
</div>


<footer id="footer" role="contentinfo" class="sixteen columns">
  <nav role="navigation">
    <ul>
      <li><a href="/">Homepage</a></li>
      <li><a href="http://twitter.com/phollow">Twitter</a></li>
      <li><a href="https://www.facebook.com/Phollow.fr">Facebook</a></li>
      <li><a href="http://dribbble.com/phollow">Dribbble</a></li>
      <li><a href="mailto:rydgel@phollow.fr">Contact</a></li>
    </ul>
  </nav>
  <span class="copyright">Copyright © 2011 <a rel="author"
      href="https://plus.google.com/113221045987282389062?rel=author"
      title="Jérôme Mahuet">+Jérôme Mahuet</a> All Rights Reserved.
    Hosted by <a href="http://www.heroku.com/">Heroku.</a></span>
<a title="Phollow.me" class="footer-logo-link" href="http://phollow.fr"><img src="/images/phollow-logo-footer.png" alt="Phollow.me"></a>
</footer>

</div><!-- container -->
<script src="/js/compiled/global.js?v=3"></script>

<!--[if (lt IE 9) & (!IEMobile)]>
<script src="/js/compiled/DOMAssistantCompressed-2.8.js"></script>
<script src="/js/compiled/selectivizr-1.0.1.js"></script>
<script src="/js/compiled/respond.min.js"></script>
<![endif]-->

<script>
      (function(){
        var twitterWidgets = document.createElement('script');
        twitterWidgets.type = 'text/javascript';
        twitterWidgets.async = true;
        twitterWidgets.src = '//platform.twitter.com/widgets.js';
        document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
      })();
</script>

<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4ec64821f5a1f55c33000003');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>
</body>
</html>

